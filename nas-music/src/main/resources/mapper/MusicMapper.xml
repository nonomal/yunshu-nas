<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="top.itning.yunshunas.music.repository.MusicRepository">
    <resultMap id="BaseResultMap" type="top.itning.yunshunas.music.entity.Music">
        <id column="id" property="id" jdbcType="INTEGER"/>
        <result column="music_id" property="musicId" jdbcType="VARCHAR"/>
        <result column="name" property="name" jdbcType="VARCHAR"/>
        <result column="singer" property="singer" jdbcType="VARCHAR"/>
        <result column="lyric_id" property="lyricId" jdbcType="VARCHAR"/>
        <result column="type" property="type" jdbcType="INTEGER"/>
        <result column="gmt_create" property="gmtCreate" jdbcType="TIMESTAMP"/>
        <result column="gmt_modified" property="gmtModified" jdbcType="TIMESTAMP"/>
    </resultMap>

    <select id="findAllByNameLikeOrSingerLike" resultMap="BaseResultMap">
        <bind name="patternName" value="'%' + name + '%'"/>
        <bind name="patternSinger" value="'%' + singer + '%'"/>
        select id,music_id,name,singer,lyric_id,type,gmt_create,gmt_modified from music where name like #{patternName}
        or singer like #{patternSinger}
    </select>

    <select id="findAllByNameLike" resultMap="BaseResultMap">
        <bind name="patternName" value="'%' + name + '%'"/>
        select id,music_id,name,singer,lyric_id,type,gmt_create,gmt_modified from music where name like #{patternName}
    </select>

    <select id="findAllBySingerLike" resultMap="BaseResultMap">
        <bind name="patternSinger" value="'%' + singer + '%'"/>
        select id,music_id,name,singer,lyric_id,type,gmt_create,gmt_modified from music where singer like
        #{patternSinger}
    </select>

    <select id="findByMusicId" resultMap="BaseResultMap">
        select id,
               music_id,
               name,
               singer,
               lyric_id,
               type,
               gmt_create,
               gmt_modified
        from music
        where music_id = #{musicId}
    </select>

    <select id="existsByName" resultType="boolean">
        select count(*)
        from music
        where name = #{name}
    </select>

    <delete id="deleteByMusicId">
        delete
        from music
        where music_id = #{musicId}
    </delete>

    <select id="findAllByNameLikeAndSingerLike" resultMap="BaseResultMap">
        <bind name="patternName" value="'%' + name + '%'"/>
        <bind name="patternSinger" value="'%' + singer + '%'"/>
        select id,music_id,name,singer,lyric_id,type,gmt_create,gmt_modified from music where name like #{patternName}
        and singer like #{patternSinger}
    </select>

    <select id="findAll" resultMap="BaseResultMap">
        select id,
               music_id,
               name,
               singer,
               lyric_id,
               type,
               gmt_create,
               gmt_modified
        from music
    </select>

    <insert id="save">
        insert into music (music_id, name, singer, lyric_id, type)
        values (#{musicId}, #{name}, #{singer}, #{lyricId}, #{type})
    </insert>

    <select id="findById" resultMap="BaseResultMap">
        select id,
               music_id,
               name,
               singer,
               lyric_id,
               type,
               gmt_create,
               gmt_modified
        from music
        where id = #{id}
    </select>
</mapper>